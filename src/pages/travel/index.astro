---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const travels = await getCollection('travel');
const sortedTravels = travels.sort((a, b) =>
  a.data.title.localeCompare(b.data.title)
);

// ãƒãƒ¼ãƒ åã¨ãƒªãƒ¼ã‚°ã®ãƒãƒƒãƒ”ãƒ³ã‚°
const teamInfo = {
  'tokyo-giants': { name: 'èª­å£²ã‚¸ãƒ£ã‚¤ã‚¢ãƒ³ãƒ„', icon: 'ğŸ¯', league: 'central', prefecture: 'æ±äº¬éƒ½' },
  'tokyo-swallows': { name: 'æ±äº¬ãƒ¤ã‚¯ãƒ«ãƒˆã‚¹ãƒ¯ãƒ­ãƒ¼ã‚º', icon: 'ğŸ¨', league: 'central', prefecture: 'æ±äº¬éƒ½' },
  'yokohama': { name: 'æ¨ªæµœDeNAãƒ™ã‚¤ã‚¹ã‚¿ãƒ¼ã‚º', icon: 'ğŸŒ‰', league: 'central', prefecture: 'ç¥å¥ˆå·çœŒ' },
  'osaka-tigers': { name: 'é˜ªç¥ã‚¿ã‚¤ã‚¬ãƒ¼ã‚¹', icon: 'ğŸ…', league: 'central', prefecture: 'å…µåº«çœŒ' },
  'nagoya': { name: 'ä¸­æ—¥ãƒ‰ãƒ©ã‚´ãƒ³ã‚º', icon: 'ğŸ°', league: 'central', prefecture: 'æ„›çŸ¥çœŒ' },
  'hiroshima': { name: 'åºƒå³¶æ±æ´‹ã‚«ãƒ¼ãƒ—', icon: 'â›©ï¸', league: 'central', prefecture: 'åºƒå³¶çœŒ' },
  'hokkaido': { name: 'åŒ—æµ·é“æ—¥æœ¬ãƒãƒ ãƒ•ã‚¡ã‚¤ã‚¿ãƒ¼ã‚º', icon: 'ğŸ”ï¸', league: 'pacific', prefecture: 'åŒ—æµ·é“' },
  'osaka-2days': { name: 'ã‚ªãƒªãƒƒã‚¯ã‚¹ãƒ»ãƒãƒ•ã‚¡ãƒ­ãƒ¼ã‚º', icon: 'ğŸƒ', league: 'pacific', prefecture: 'å¤§é˜ªåºœ' },
  'saitama': { name: 'åŸ¼ç‰è¥¿æ­¦ãƒ©ã‚¤ã‚ªãƒ³ã‚º', icon: 'ğŸŒ¸', league: 'pacific', prefecture: 'åŸ¼ç‰çœŒ' },
  'chiba-lotte': { name: 'åƒè‘‰ãƒ­ãƒƒãƒ†ãƒãƒªãƒ¼ãƒ³ã‚º', icon: 'ğŸŒŠ', league: 'pacific', prefecture: 'åƒè‘‰çœŒ' },
  'chiba': { name: 'åƒè‘‰ãƒ­ãƒƒãƒ†ãƒãƒªãƒ¼ãƒ³ã‚º', icon: 'ğŸŒŠ', league: 'pacific', prefecture: 'åƒè‘‰çœŒ' },
  'miyagi': { name: 'æ±åŒ—æ¥½å¤©ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¤ãƒ¼ã‚°ãƒ«ã‚¹', icon: 'ğŸ¦…', league: 'pacific', prefecture: 'å®®åŸçœŒ' },
  'fukuoka': { name: 'ç¦å²¡ã‚½ãƒ•ãƒˆãƒãƒ³ã‚¯ãƒ›ãƒ¼ã‚¯ã‚¹', icon: 'ğŸœ', league: 'pacific', prefecture: 'ç¦å²¡çœŒ' }
};

function getTeamInfo(slug) {
  // ã‚ˆã‚Šæ­£ç¢ºãªãƒãƒƒãƒãƒ³ã‚°ã®ãŸã‚ã€ã‚ˆã‚Šé•·ã„ã‚­ãƒ¼ã‹ã‚‰è©¦ã™
  const sortedKeys = Object.keys(teamInfo).sort((a, b) => b.length - a.length);
  const teamKey = sortedKeys.find(key => slug.includes(key));
  return teamKey ? { key: teamKey, ...teamInfo[teamKey] } : { 
    key: '', 
    name: 'çƒå›£æœªå®š', 
    icon: 'âš¾', 
    league: 'central',
    prefecture: 'æœªå®š'
  };
}

// ã‚»ãƒ»ãƒªãƒ¼ã‚°ã¨ãƒ‘ãƒ»ãƒªãƒ¼ã‚°ã«åˆ†ã‘ã¦æ•´ç†
const centralTravels = sortedTravels.filter(travel => {
  const info = getTeamInfo(travel.slug);
  return info.league === 'central';
});

const pacificTravels = sortedTravels.filter(travel => {
  const info = getTeamInfo(travel.slug);
  return info.league === 'pacific';
});
---

<BaseLayout
  title="ãƒ¢ãƒ‡ãƒ«ã‚³ãƒ¼ã‚¹ä¸€è¦§ - ãƒ—ãƒ­é‡çƒè¦³æˆ¦æ—…è¡Œãƒ—ãƒ©ãƒ³"
  description="å…¨12çƒå›£ã®è¦³æˆ¦ï¼‹è¦³å…‰ãƒ¢ãƒ‡ãƒ«ã‚³ãƒ¼ã‚¹ã€‚é‡çƒè¦³æˆ¦ã¨å„åœ°ã®é­…åŠ›ã‚’æº€å–«ã™ã‚‹æ—…è¡Œãƒ—ãƒ©ãƒ³ã®æ±ºå®šç‰ˆã€‚"
>
  <header class="travel-hero">
    <div class="hero-overlay">
      <div class="hero-content">
        <h1 class="hero-title">âš¾ ãƒ—ãƒ­é‡çƒè¦³æˆ¦æ—…è¡Œ</h1>
        <h2 class="hero-subtitle">ãƒ¢ãƒ‡ãƒ«ã‚³ãƒ¼ã‚¹ä¸€è¦§</h2>
        <p class="hero-description">
          é‡çƒè¦³æˆ¦ã¨å„åœ°ã®é­…åŠ›ã‚’çµ„ã¿åˆã‚ã›ãŸã€å……å®Ÿã®æ—…è¡Œãƒ—ãƒ©ãƒ³ã‚’ã”ææ¡ˆ
        </p>
        <div class="hero-stats">
          <div class="stat-item">
            <span class="stat-number">12</span>
            <span class="stat-label">çƒå›£</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">{sortedTravels.length}</span>
            <span class="stat-label">ãƒ—ãƒ©ãƒ³</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">1-3æ³Š</span>
            <span class="stat-label">ã‚³ãƒ¼ã‚¹</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="travel-main">
    <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
    <section class="filter-section">
      <div class="filter-container">
        <h3 class="filter-title">ğŸ” ãƒ—ãƒ©ãƒ³ã‚’çµã‚Šè¾¼ã‚€</h3>
        <div class="filter-groups">
          <div class="filter-group">
            <label class="filter-label">ãƒªãƒ¼ã‚°</label>
            <div class="filter-buttons">
              <button class="filter-btn active" data-filter="all">ã™ã¹ã¦</button>
              <button class="filter-btn" data-filter="central">ã‚»ãƒ»ãƒªãƒ¼ã‚°</button>
              <button class="filter-btn" data-filter="pacific">ãƒ‘ãƒ»ãƒªãƒ¼ã‚°</button>
            </div>
          </div>
          <div class="filter-group">
            <label class="filter-label">å®¿æ³Šæ—¥æ•°</label>
            <div class="filter-buttons">
              <button class="filter-btn active" data-duration="all">ã™ã¹ã¦</button>
              <button class="filter-btn" data-duration="1æ³Š2æ—¥">1æ³Š2æ—¥</button>
              <button class="filter-btn" data-duration="2æ³Š3æ—¥">2æ³Š3æ—¥</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- å…¨ãƒ—ãƒ©ãƒ³è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <section class="all-plans-section">
      <div class="league-header">
        <h2 class="league-title" id="results-title">ğŸ“‹ å…¨ãƒ—ãƒ©ãƒ³ä¸€è¦§</h2>
        <p class="league-description" id="results-description">ã™ã¹ã¦ã®é‡çƒè¦³æˆ¦æ—…è¡Œãƒ—ãƒ©ãƒ³ã‚’ä¸€è¦§ã§ã”ç¢ºèªã„ãŸã ã‘ã¾ã™</p>
      </div>

      <div class="course-grid" id="filtered-results">
        {sortedTravels.map((travel) => {
          const info = getTeamInfo(travel.slug);
          const cardClass = info.league === 'pacific' ? 'pacific-league' : 'central-league';
          
          return (
            <article class={`course-card ${cardClass}`} data-league={info.league} data-duration={travel.data.duration}>
              <div class="course-image">
                <div class="course-icon">{info.icon}</div>
                <div class="course-badge">{info.prefecture}</div>
              </div>
              <div class="course-content">
                <h3 class="course-title">{travel.data.title}</h3>
                <p class="course-team">{info.name}</p>
                <p class="course-description">{travel.data.description}</p>
                <div class="course-details">
                  <span class="course-duration">{travel.data.duration}</span>
                  <span class="course-budget">{travel.data.cost.budget}</span>
                </div>
                <a href={`/travel/${travel.slug}`} class="course-link">
                  è©³ç´°ã‚’è¦‹ã‚‹ <span class="link-arrow">â†’</span>
                </a>
              </div>
            </article>
          );
        })}
      </div>
    </section>

    <!-- ä»¥å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯å‰Šé™¤ã—ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¯¾å¿œã®çµ±åˆè¡¨ç¤ºã«å¤‰æ›´ -->

    <!-- ãƒ—ãƒ©ãƒ³æ¯”è¼ƒ -->
    <section class="comparison-section">
      <div class="comparison-header">
        <h2 class="comparison-title">ğŸ’¡ ãƒ—ãƒ©ãƒ³é¸ã³ã®ã‚³ãƒ„</h2>
        <p class="comparison-description">
          ã‚ãªãŸã«ã´ã£ãŸã‚Šã®è¦³æˆ¦æ—…è¡Œãƒ—ãƒ©ãƒ³ã‚’è¦‹ã¤ã‘ã‚ˆã†
        </p>
      </div>

      <div class="comparison-grid">
        <div class="comparison-card">
          <div class="comparison-icon">ğŸ’°</div>
          <h3>äºˆç®—é‡è¦–</h3>
          <p>3-6ä¸‡å††ã®ä½äºˆç®—ãƒ—ãƒ©ãƒ³</p>
          <ul class="comparison-list">
            <li>åŸ¼ç‰ã®ã‚“ã³ã‚Šã‚³ãƒ¼ã‚¹</li>
            <li>åƒè‘‰ãƒãƒªãƒ³ã‚³ãƒ¼ã‚¹</li>
            <li>åå¤å±‹ã‚°ãƒ«ãƒ¡ã‚³ãƒ¼ã‚¹</li>
          </ul>
        </div>

        <div class="comparison-card">
          <div class="comparison-icon">ğŸ½ï¸</div>
          <h3>ã‚°ãƒ«ãƒ¡é‡è¦–</h3>
          <p>ã”å½“åœ°ã‚°ãƒ«ãƒ¡ã‚’å ªèƒ½</p>
          <ul class="comparison-list">
            <li>å¤§é˜ªé£Ÿã„å€’ã‚Œã‚³ãƒ¼ã‚¹</li>
            <li>åå¤å±‹ã‚°ãƒ«ãƒ¡ã‚³ãƒ¼ã‚¹</li>
            <li>å®®åŸã‚°ãƒ«ãƒ¡ã‚³ãƒ¼ã‚¹</li>
            <li>ç¦å²¡ã‚°ãƒ«ãƒ¡ã‚³ãƒ¼ã‚¹</li>
          </ul>
        </div>

        <div class="comparison-card">
          <div class="comparison-icon">ğŸ›ï¸</div>
          <h3>è¦³å…‰é‡è¦–</h3>
          <p>æ­´å²ãƒ»æ–‡åŒ–ã‚’æº€å–«</p>
          <ul class="comparison-list">
            <li>æ±äº¬ç‹é“è¦³å…‰ã‚³ãƒ¼ã‚¹</li>
            <li>å¹³å’Œãƒ»å®®å³¶æº€å–«ã‚³ãƒ¼ã‚¹</li>
            <li>å¤§é˜ªãƒ»ç¥æˆ¸æº€å–«ã‚³ãƒ¼ã‚¹</li>
          </ul>
        </div>

        <div class="comparison-card">
          <div class="comparison-icon">ğŸŒŸ</div>
          <h3>ç‰¹åˆ¥ä½“é¨“é‡è¦–</h3>
          <p>ã“ã“ã§ã—ã‹ã§ããªã„ä½“é¨“</p>
          <ul class="comparison-list">
            <li>åŒ—æµ·é“å¤§è‡ªç„¶ã‚³ãƒ¼ã‚¹</li>
            <li>æ±äº¬ãƒ¢ãƒ€ãƒ³è¦³å…‰ã‚³ãƒ¼ã‚¹</li>
            <li>æ¨ªæµœã¿ãªã¨ã¿ã‚‰ã„ã‚³ãƒ¼ã‚¹</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="cta-section">
      <div class="cta-content">
        <h2 class="cta-title">âš¾ é‡çƒè¦³æˆ¦æ—…è¡Œã‚’ã¯ã˜ã‚ã‚ˆã†</h2>
        <p class="cta-description">
          ãŠæ°—ã«å…¥ã‚Šã®çƒå›£ã€è¡ŒããŸã„å ´æ‰€ã‹ã‚‰æ—…è¡Œãƒ—ãƒ©ãƒ³ã‚’é¸ã‚“ã§ã€æœ€é«˜ã®è¦³æˆ¦æ—…è¡Œä½“é¨“ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚
        </p>
        <div class="cta-buttons">
          <a href="/guides" class="cta-button primary">è¦³æˆ¦ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹</a>
          <a href="/" class="cta-button secondary">çƒå ´ãƒãƒƒãƒ—ã«æˆ»ã‚‹</a>
        </div>
      </div>
    </section>
  </main>
</BaseLayout>

<style>
  @import './index.css';
  
  /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
  .filter-section {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    padding: 2rem 1rem;
    margin: 2rem -1rem;
    border-radius: 20px;
  }
  
  .filter-container {
    max-width: 1200px;
    margin: 0 auto;
  }
  
  .filter-title {
    text-align: center;
    color: #2c3e50;
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
    font-weight: 600;
  }
  
  .filter-groups {
    display: flex;
    gap: 3rem;
    justify-content: center;
    flex-wrap: wrap;
  }
  
  .filter-group {
    text-align: center;
  }
  
  .filter-label {
    display: block;
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 0.8rem;
    font-size: 1.1rem;
  }
  
  .filter-buttons {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .filter-btn {
    padding: 0.6rem 1.2rem;
    border: 2px solid #3498db;
    background: white;
    color: #3498db;
    border-radius: 25px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s;
    font-size: 0.9rem;
  }
  
  .filter-btn:hover {
    background: #3498db;
    color: white;
    transform: translateY(-1px);
  }
  
  .filter-btn.active {
    background: #3498db;
    color: white;
    box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
  }
  
  .all-plans-section {
    margin-bottom: 3rem;
  }
  
  @media (max-width: 768px) {
    .filter-groups {
      flex-direction: column;
      gap: 2rem;
    }
    
    .filter-buttons {
      justify-content: center;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const filterButtons = document.querySelectorAll('.filter-btn');
    const courseCards = document.querySelectorAll('.course-card');
    const resultsTitle = document.getElementById('results-title');
    const resultsDescription = document.getElementById('results-description');
    
    let currentLeagueFilter = 'all';
    let currentDurationFilter = 'all';
    
    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    filterButtons.forEach(button => {
      button.addEventListener('click', function() {
        const filterType = this.dataset.filter || this.dataset.duration;
        
        if (this.dataset.filter) {
          // ãƒªãƒ¼ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
          document.querySelectorAll('[data-filter]').forEach(btn => btn.classList.remove('active'));
          this.classList.add('active');
          currentLeagueFilter = filterType;
        } else if (this.dataset.duration) {
          // å®¿æ³Šæ—¥æ•°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
          document.querySelectorAll('[data-duration]').forEach(btn => btn.classList.remove('active'));
          this.classList.add('active');
          currentDurationFilter = filterType;
        }
        
        applyFilters();
      });
    });
    
    function applyFilters() {
      let visibleCount = 0;
      
      courseCards.forEach(card => {
        const cardLeague = card.dataset.league;
        const cardDuration = card.dataset.duration;
        
        const leagueMatch = currentLeagueFilter === 'all' || cardLeague === currentLeagueFilter;
        const durationMatch = currentDurationFilter === 'all' || cardDuration === currentDurationFilter;
        
        if (leagueMatch && durationMatch) {
          card.style.display = 'block';
          visibleCount++;
        } else {
          card.style.display = 'none';
        }
      });
      
      updateResultsTitle(visibleCount);
    }
    
    function updateResultsTitle(count) {
      let title = 'ğŸ“‹ ';
      let description = '';
      
      if (currentLeagueFilter === 'all' && currentDurationFilter === 'all') {
        title += 'å…¨ãƒ—ãƒ©ãƒ³ä¸€è¦§';
        description = 'ã™ã¹ã¦ã®é‡çƒè¦³æˆ¦æ—…è¡Œãƒ—ãƒ©ãƒ³ã‚’ä¸€è¦§ã§ã”ç¢ºèªã„ãŸã ã‘ã¾ã™';
      } else {
        const leagueText = currentLeagueFilter === 'central' ? 'ã‚»ãƒ»ãƒªãƒ¼ã‚°' : 
                          currentLeagueFilter === 'pacific' ? 'ãƒ‘ãƒ»ãƒªãƒ¼ã‚°' : '';
        const durationText = currentDurationFilter !== 'all' ? currentDurationFilter : '';
        
        const filterTexts = [leagueText, durationText].filter(text => text).join(' ');
        title += `${filterTexts} ãƒ—ãƒ©ãƒ³ä¸€è¦§`;
        description = `${filterTexts}ã®é‡çƒè¦³æˆ¦æ—…è¡Œãƒ—ãƒ©ãƒ³ï¼ˆ${count}ä»¶ï¼‰`;
      }
      
      resultsTitle.textContent = title;
      resultsDescription.textContent = description;
    }
  });
</script>
