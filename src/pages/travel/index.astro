---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const travels = await getCollection('travel');
const sortedTravels = travels.sort((a, b) =>
  a.data.title.localeCompare(b.data.title)
);

// チーム名とリーグのマッピング
const teamInfo = {
  'tokyo-giants': { name: '読売ジャイアンツ', icon: '🏯', league: 'central', prefecture: '東京都' },
  'tokyo-swallows': { name: '東京ヤクルトスワローズ', icon: '🎨', league: 'central', prefecture: '東京都' },
  'yokohama': { name: '横浜DeNAベイスターズ', icon: '🌉', league: 'central', prefecture: '神奈川県' },
  'osaka-tigers': { name: '阪神タイガース', icon: '🐅', league: 'central', prefecture: '兵庫県' },
  'nagoya': { name: '中日ドラゴンズ', icon: '🏰', league: 'central', prefecture: '愛知県' },
  'hiroshima': { name: '広島東洋カープ', icon: '⛩️', league: 'central', prefecture: '広島県' },
  'hokkaido': { name: '北海道日本ハムファイターズ', icon: '🏔️', league: 'pacific', prefecture: '北海道' },
  'osaka-2days': { name: 'オリックス・バファローズ', icon: '🐃', league: 'pacific', prefecture: '大阪府' },
  'saitama': { name: '埼玉西武ライオンズ', icon: '🌸', league: 'pacific', prefecture: '埼玉県' },
  'chiba-lotte': { name: '千葉ロッテマリーンズ', icon: '🌊', league: 'pacific', prefecture: '千葉県' },
  'chiba': { name: '千葉ロッテマリーンズ', icon: '🌊', league: 'pacific', prefecture: '千葉県' },
  'miyagi': { name: '東北楽天ゴールデンイーグルス', icon: '🦅', league: 'pacific', prefecture: '宮城県' },
  'fukuoka': { name: '福岡ソフトバンクホークス', icon: '🍜', league: 'pacific', prefecture: '福岡県' }
};

function getTeamInfo(slug) {
  // より正確なマッチングのため、より長いキーから試す
  const sortedKeys = Object.keys(teamInfo).sort((a, b) => b.length - a.length);
  const teamKey = sortedKeys.find(key => slug.includes(key));
  return teamKey ? { key: teamKey, ...teamInfo[teamKey] } : { 
    key: '', 
    name: '球団未定', 
    icon: '⚾', 
    league: 'central',
    prefecture: '未定'
  };
}

// セ・リーグとパ・リーグに分けて整理
const centralTravels = sortedTravels.filter(travel => {
  const info = getTeamInfo(travel.slug);
  return info.league === 'central';
});

const pacificTravels = sortedTravels.filter(travel => {
  const info = getTeamInfo(travel.slug);
  return info.league === 'pacific';
});
---

<BaseLayout
  title="モデルコース一覧 - プロ野球観戦旅行プラン"
  description="全12球団の観戦＋観光モデルコース。野球観戦と各地の魅力を満喫する旅行プランの決定版。"
>
  <header class="travel-hero">
    <div class="hero-overlay">
      <div class="hero-content">
        <h1 class="hero-title">⚾ プロ野球観戦旅行</h1>
        <h2 class="hero-subtitle">モデルコース一覧</h2>
        <p class="hero-description">
          野球観戦と各地の魅力を組み合わせた、充実の旅行プランをご提案
        </p>
        <div class="hero-stats">
          <div class="stat-item">
            <span class="stat-number">12</span>
            <span class="stat-label">球団</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">{sortedTravels.length}</span>
            <span class="stat-label">プラン</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">1-3泊</span>
            <span class="stat-label">コース</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="travel-main">
    <!-- セ・リーグ -->
    <section class="league-section">
      <div class="league-header">
        <h2 class="league-title">🔴 セントラル・リーグ</h2>
        <p class="league-description">伝統と歴史ある6球団の本拠地を巡る旅</p>
      </div>

      <div class="course-grid">
        {centralTravels.map((travel) => {
          const info = getTeamInfo(travel.slug);
          return (
            <article class="course-card central-league">
              <div class="course-image">
                <div class="course-icon">{info.icon}</div>
                <div class="course-badge">{info.prefecture}</div>
              </div>
              <div class="course-content">
                <h3 class="course-title">{travel.data.title}</h3>
                <p class="course-team">{info.name}</p>
                <p class="course-description">{travel.data.description}</p>
                <div class="course-details">
                  <span class="course-duration">{travel.data.duration}</span>
                  <span class="course-budget">{travel.data.cost.budget}</span>
                </div>
                <a href={`/travel/${travel.slug}`} class="course-link">
                  詳細を見る <span class="link-arrow">→</span>
                </a>
              </div>
            </article>
          );
        })}
      </div>
    </section>

    <!-- パ・リーグ -->
    <section class="league-section">
      <div class="league-header">
        <h2 class="league-title">🔵 パシフィック・リーグ</h2>
        <p class="league-description">革新的で魅力ある6球団の本拠地を巡る旅</p>
      </div>

      <div class="course-grid">
        {pacificTravels.map((travel) => {
          const info = getTeamInfo(travel.slug);
          return (
            <article class="course-card pacific-league">
              <div class="course-image">
                <div class="course-icon">{info.icon}</div>
                <div class="course-badge">{info.prefecture}</div>
              </div>
              <div class="course-content">
                <h3 class="course-title">{travel.data.title}</h3>
                <p class="course-team">{info.name}</p>
                <p class="course-description">{travel.data.description}</p>
                <div class="course-details">
                  <span class="course-duration">{travel.data.duration}</span>
                  <span class="course-budget">{travel.data.cost.budget}</span>
                </div>
                <a href={`/travel/${travel.slug}`} class="course-link">
                  詳細を見る <span class="link-arrow">→</span>
                </a>
              </div>
            </article>
          );
        })}
      </div>
    </section>

    <!-- 全プラン一覧 -->
    <section class="league-section">
      <div class="league-header">
        <h2 class="league-title">📋 全プラン一覧</h2>
        <p class="league-description">すべての野球観戦旅行プランを一覧でご確認いただけます</p>
      </div>

      <div class="course-grid">
        {sortedTravels.map((travel) => {
          const info = getTeamInfo(travel.slug);
          const cardClass = info.league === 'pacific' ? 'pacific-league' : 'central-league';
          
          return (
            <article class={`course-card ${cardClass}`}>
              <div class="course-image">
                <div class="course-icon">{info.icon}</div>
                <div class="course-badge">{info.prefecture}</div>
              </div>
              <div class="course-content">
                <h3 class="course-title">{travel.data.title}</h3>
                <p class="course-team">{info.name}</p>
                <p class="course-description">{travel.data.description}</p>
                <div class="course-details">
                  <span class="course-duration">{travel.data.duration}</span>
                  <span class="course-budget">{travel.data.cost.budget}</span>
                </div>
                <a href={`/travel/${travel.slug}`} class="course-link">
                  詳細を見る <span class="link-arrow">→</span>
                </a>
              </div>
            </article>
          );
        })}
      </div>
    </section>

    <!-- プラン比較 -->
    <section class="comparison-section">
      <div class="comparison-header">
        <h2 class="comparison-title">💡 プラン選びのコツ</h2>
        <p class="comparison-description">
          あなたにぴったりの観戦旅行プランを見つけよう
        </p>
      </div>

      <div class="comparison-grid">
        <div class="comparison-card">
          <div class="comparison-icon">💰</div>
          <h3>予算重視</h3>
          <p>3-6万円の低予算プラン</p>
          <ul class="comparison-list">
            <li>埼玉のんびりコース</li>
            <li>千葉マリンコース</li>
            <li>名古屋グルメコース</li>
          </ul>
        </div>

        <div class="comparison-card">
          <div class="comparison-icon">🍽️</div>
          <h3>グルメ重視</h3>
          <p>ご当地グルメを堪能</p>
          <ul class="comparison-list">
            <li>大阪食い倒れコース</li>
            <li>名古屋グルメコース</li>
            <li>宮城グルメコース</li>
            <li>福岡グルメコース</li>
          </ul>
        </div>

        <div class="comparison-card">
          <div class="comparison-icon">🏛️</div>
          <h3>観光重視</h3>
          <p>歴史・文化を満喫</p>
          <ul class="comparison-list">
            <li>東京王道観光コース</li>
            <li>平和・宮島満喫コース</li>
            <li>大阪・神戸満喫コース</li>
          </ul>
        </div>

        <div class="comparison-card">
          <div class="comparison-icon">🌟</div>
          <h3>特別体験重視</h3>
          <p>ここでしかできない体験</p>
          <ul class="comparison-list">
            <li>北海道大自然コース</li>
            <li>東京モダン観光コース</li>
            <li>横浜みなとみらいコース</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="cta-section">
      <div class="cta-content">
        <h2 class="cta-title">⚾ 野球観戦旅行をはじめよう</h2>
        <p class="cta-description">
          お気に入りの球団、行きたい場所から旅行プランを選んで、最高の観戦旅行体験を始めましょう。
        </p>
        <div class="cta-buttons">
          <a href="/guides" class="cta-button primary">観戦ガイドを見る</a>
          <a href="/" class="cta-button secondary">球場マップに戻る</a>
        </div>
      </div>
    </section>
  </main>
</BaseLayout>

<style>
  @import './index.css';
</style>
