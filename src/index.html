<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ãƒ—ãƒ­é‡çƒ12çƒå›£æœ¬æ‹ åœ°ãƒãƒƒãƒ—</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="weather.css">
  </head>
  <body>
    <div class="header">
      <h1>ãƒ—ãƒ­é‡çƒ12çƒå›£æœ¬æ‹ åœ°ãƒãƒƒãƒ—</h1>
      <p>æ—¥æœ¬ãƒ—ãƒ­é‡çƒ12çƒå›£ã®æœ¬æ‹ åœ°çƒå ´ã‚’åœ°å›³ä¸Šã§ç¢ºèªã§ãã¾ã™</p>
    </div>

    <div class="league-toggle">
      <button class="league-btn" onclick="showAllTeams()">å…¨çƒå ´</button>
      <button class="league-btn active" onclick="showMainTeams()">1è»ã®ã¿</button>
      <button class="league-btn" onclick="showFarmTeams()">ãƒ•ã‚¡ãƒ¼ãƒ ã®ã¿</button>
      <button class="league-btn regional" onclick="showRegionalStadiums()">åœ°æ–¹é–‹å‚¬</button>
    </div>
    
    <div class="league-toggle">
      <button class="league-btn central" onclick="showCentralLeague()">ã‚»ãƒ»ãƒªãƒ¼ã‚°</button>
      <button class="league-btn pacific" onclick="showPacificLeague()">ãƒ‘ãƒ»ãƒªãƒ¼ã‚°</button>
      <button class="league-btn eastern" onclick="showEasternLeague()">ã‚¤ãƒ¼ã‚¹ã‚¿ãƒ³</button>
      <button class="league-btn western" onclick="showWesternLeague()">ã‚¦ã‚¨ã‚¹ã‚¿ãƒ³</button>
    </div>

    <div id="map"></div>

    <div id="team-info" style="display: none;">
      <h2 id="team-name"></h2>
      <p><strong>çƒå ´:</strong> <span id="stadium-name"></span></p>
      <p><strong>æ‰€åœ¨åœ°:</strong> <span id="location"></span></p>
      <p><strong>ãƒªãƒ¼ã‚°:</strong> <span id="league"></span></p>
      <div id="weather-info"></div>
      <div style="margin-top: 1rem;">
        <a id="guide-link" href="#" style="display: inline-block; background: #3498db; color: white; padding: 0.5rem 1rem; text-decoration: none; border-radius: 5px;">ğŸ“– è¦³æˆ¦ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹</a>
      </div>
    </div>


    <script type="module">
      // ç’°å¢ƒå¤‰æ•°ã‹ã‚‰APIã‚­ãƒ¼ã‚’å–å¾—
      const GOOGLE_MAPS_API_KEY = import.meta.env.VITE_GOOGLE_MAPS_API_KEY;

      // Google Maps APIã‚’å‹•çš„ã«èª­ã¿è¾¼ã¿
      function loadGoogleMapsAPI() {
        if (!GOOGLE_MAPS_API_KEY) {
          console.error('Google Maps API ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
          return;
        }
        
        const script = document.createElement('script');
        script.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_API_KEY}&callback=initMap&language=ja&region=JP`;
        script.async = true;
        script.defer = true;
        document.head.appendChild(script);
      }


      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«APIã‚’èª­ã¿è¾¼ã¿
      document.addEventListener('DOMContentLoaded', loadGoogleMapsAPI);
      
      // å¤©æ°—æƒ…å ±çµ±åˆç”¨ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
      window.updateTeamWeatherInfo = async function(stadium) {
        const weatherInfoDiv = document.getElementById('weather-info');
        const guideLink = document.getElementById('guide-link');
        
        if (weatherInfoDiv) {
          weatherInfoDiv.innerHTML = '<div style="color: #666; font-size: 0.9rem;">å¤©æ°—æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>';
          
          try {
            // å¤©æ°—UIæ©Ÿèƒ½ã‚’å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
            const { createCompactWeatherInfo } = await import('./weather-ui.js');
            
            // ãƒ‰ãƒ¼ãƒ çƒå ´ã®åˆ¤å®š
            const isIndoor = stadium.stadium.includes('ãƒ‰ãƒ¼ãƒ ') || 
                           stadium.stadium.includes('ãƒ‰ãƒ¼ãƒ ') ||
                           stadium.stadium === 'æ±äº¬ãƒ‰ãƒ¼ãƒ ';
            
            const weatherHtml = await createCompactWeatherInfo(stadium, isIndoor);
            weatherInfoDiv.innerHTML = weatherHtml;
          } catch (error) {
            console.error('Weather info error:', error);
            weatherInfoDiv.innerHTML = '<div style="color: #999; font-size: 0.8rem;">å¤©æ°—æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ</div>';
          }
        }
        
        // è¦³æˆ¦ã‚¬ã‚¤ãƒ‰ãƒªãƒ³ã‚¯ã‚’æ›´æ–°
        if (guideLink && stadium.guideUrl) {
          guideLink.href = stadium.guideUrl;
          guideLink.style.display = 'inline-block';
        } else if (guideLink) {
          guideLink.style.display = 'none';
        }
      };
    </script>
    <script type="module" src="script.js"></script>
  </body>
</html>
